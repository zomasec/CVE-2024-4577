package utils

import (
	"bufio"
	"fmt"
	"os"
    "net"
	"strings"
)

func ContainsPHPVersion(response string) bool {
    return strings.Contains(response, "PHP Version")
}

func ReadHostsFromFile(file string) ([]string, error) {
    var hosts []string

    if file != "" {
        file, err := os.Open(file)
        if err != nil {
            return nil, err
        }
        defer file.Close()

        scanner := bufio.NewScanner(file)
        for scanner.Scan() {
            line := scanner.Text()
            if line != "" {
                hosts = append(hosts, line)
            }
        }

        if err := scanner.Err(); err != nil {
            return nil, err
        }
    }

    return hosts, nil
}

func AddHTTPSPrefix(hosts []string) []string {
	var withHTTPS []string
	for _, host := range hosts {
        if isIP(host){
            withHTTPS = append(withHTTPS, fmt.Sprintf("https://%s", host))	
        } else {
            continue
        }
	}
	return withHTTPS
}



func isIP(host string) bool {
    return net.ParseIP(host) != nil
}